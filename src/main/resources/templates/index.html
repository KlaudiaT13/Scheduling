<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>

    <script src="/static/d3.v7.js"></script>
    <script src="/static/json_view.js"></script>

    <link rel="icon" type="image/svg+xml" href="/static/logo.svg"/>

</head>
<body>
<h3 style="color: #4695EB">aaaa</h3>

<label for="file-select">Choose a file:</label>
<select name="jobsfile" id="file-select">
    <option value="">Choose file with jobs</option>
    {#for file in files}
        <option value={file}>{file}</option>
    {/for}
</select>

<div id="container"></div>

</body>
<script type="module">

    // Declare the chart dimensions and margins.
    const width = 640;
    const height = 400;
    const marginTop = 20;
    const marginRight = 20;
    const marginBottom = 30;
    const marginLeft = 40;
    const data = {results.raw};

    // Declare the x (horizontal position) scale.
    // const x = d3.scaleUtc()
    //     .domain([new Date("2023-01-01"), new Date("2024-01-01")])
    //     .range([marginLeft, width - marginRight]);
    const x = d3.scaleLinear()
        .domain([0, 10])
        .range([marginLeft, width - marginRight]);

    // Declare the y (vertical position) scale.
    // const y = d3.scaleLinear()
    //     .domain([0, 100])
    //     .range([height - marginBottom, marginTop]);

    const y = d3.scaleBand()
        // .domain(d3.sort(data, d => -d.computationResult.computationTime).map(d => d.description))
        .domain(d3.sort(data, d => d.description).map(d => d.description))
        // .domain(d3.map(d => d.description))
        .rangeRound([marginTop, height - marginBottom])
        .padding(0.1);

    // Create the SVG container.
    const svg = d3.create("svg")
        .attr("width", width)
        .attr("height", height);

    // Add the x-axis.
    svg.append("g")
        .attr("transform", `translate(0,$\{height - marginBottom\})`)
        .call(d3.axisBottom(x));

    // Add the y-axis.
    svg.append("g")
        .attr("transform", `translate($\{marginLeft\},0)`)
        .call(d3.axisLeft(y));

    svg.append("g")
        .attr("fill", "steelblue")
        .selectAll()
        .data(data)
        .join("rect")
        .attr("x", x(0))
        .attr("y", (d) => y(d.description))
        .attr("width", (d) => x(d.computationResult.computationTime) - x(0))
        .attr("height", y.bandwidth());

    // Append the SVG element.
    container.append(svg.node());

    // console.log("\n\n" + result + "\n\n");

    // const obj = JSON.parse(results);
    // console.log(obj.count);
    //console.log(obj.result);
    console.log("\n\n===========================\n\n");

</script>

<h2 style="color: #4695EB">Result:</h2>

<andypf-json-viewer
        indent="2"
        expanded="false"
        theme="material"
        show-data-types="false"
        show-toolbar="true"
        expand-icon-type="square"
        show-copy="true"
        show-size="true"
>
    {results.raw}
</andypf-json-viewer>

<h2 style="color: #4695EB">Jobs:</h2>
<andypf-json-viewer
        indent="2"
        expanded="false"
        theme="material"
        show-data-types="false"
        show-toolbar="true"
        expand-icon-type="square"
        show-copy="true"
        show-size="true"
>
    {jobs.raw}
</andypf-json-viewer>
</html>